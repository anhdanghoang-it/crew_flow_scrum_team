# Copilot Instructions for Scrum Team Crew

This repository hosts the "Demon Team" CrewAI project, a multi-agent system for automated software development. It supports a dual-architecture approach: orchestrated CrewAI flows and lightweight Copilot Custom Agents.

## üèó Project Architecture

### Dual Agent Model
1.  **CrewAI Flow (`src/scrum_team/`)**:
    -   **Orchestrator**: `src/scrum_team/main.py` (`ScrumFlow` class).
    -   **Agents**: Defined in `src/scrum_team/crews/` and configured in `src/scrum_team/config/`.
    -   **Execution**: Runs a stateful pipeline: Requirements ‚Üí User Stories ‚Üí Tech Design ‚Üí Backend ‚Üí Frontend ‚Üí QA.
2.  **Copilot Custom Agents (`.github/agents/`)**:
    -   Markdown-based agent definitions for ad-hoc tasks (e.g., `pm_user_stories.md`, `tech_lead.md`).
    -   Used for rapid iteration within VS Code / GitHub Copilot.

### Directory Structure
-   `src/scrum_team/`: Core CrewAI logic (flows, crews, tools).
-   `src/crew_generated/engineering/`: **Target directory for all AI-generated code** (Backend modules, `app.py`).
-   `docs/`: Documentation artifacts (Requirements, User Stories, Test Plans).
-   `e2e/`: Playwright test specifications.
-   `.github/agents/`: Definitions for Copilot Custom Agents.

## üöÄ Development Workflows

### Dependency Management
-   Uses **uv** for Python dependency management.
-   Install: `pip install uv` -> `crewai install`.

### Running the Application
-   **Full Flow**: `crewai run` (executes `kickoff` in `main.py`).
-   **Gradio UI**: `python src/crew_generated/engineering/app.py`.
    -   *Note*: The app is often generated by the flow. Ensure it exists before running.

### Testing
-   **End-to-End**: Playwright tests are located in `e2e/`.
-   **Test Generation**: The `PlaywrightQaDemon` crew generates tests based on the test plan.

## üìù Coding Conventions

### Generated Code
-   **Location**: Always place generated application code in `src/crew_generated/engineering/`.
-   **Frontend**: Uses **Gradio** for UI (`app.py`).
-   **Backend**: Python classes/modules.

### Python Style
-   Follow standard Python best practices (PEP 8).
-   Use `pydantic` for data validation and structured outputs in agents.

### Agent Definitions
-   When creating new Copilot Agents in `.github/agents/`:
    -   Define **Objective**, **Inputs**, **Outputs**, and **Validation**.
    -   Use clear markdown structure.

## üîç Contextual Tips
-   **`ScrumFlow` State**: The `ScrumState` class in `main.py` holds the artifacts (stories, code, plans) as they move through the pipeline.
-   **Subprocess Execution**: The flow may start the Gradio app as a subprocess to run QA tests against it.
-   **File Saving**: The `_save_code_to_file` method in `main.py` handles cleaning markdown fences from LLM outputs before saving.
